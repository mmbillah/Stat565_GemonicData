df1=as.data.frame(t(df))
df1$sorted_array1=sort(df1[,2])
View(df1)
df=read.csv("/Users/muhtasim/Desktop/Stat565_HW2/data_normal.csv",header = TRUE)
#r1=order(df[1,])
#r2=sort(df[2,])
#r3=sort(df[3,])
#library(dplyr)
#df1=rbind(r1,r2,r3)
df1=as.data.frame(t(df))
df1$sorted_array1=sort(df1[,2])
df1$sorted_array2=sort(df1[,3])
df1$sorted_array3=sort(df1[,4])
View(df1)
df1$average=mean(df1[,4:6])
df1$average=average(df1[,4:6])
df1$average=m(df1[,4:6])
df1$average=mean(df1[,4:6])
df1$average=mean(df1[,4:6],na.rm=TRUE)
df1$average=colMeans(df1[,4:6],na.rm=TRUE)
df1$average=colMeans(df1[1,4:6],na.rm=TRUE)
df=read.csv("/Users/muhtasim/Desktop/Stat565_HW2/data_normal.csv",header = TRUE)
#r1=order(df[1,])
#r2=sort(df[2,])
#r3=sort(df[3,])
#library(dplyr)
#df1=rbind(r1,r2,r3)
df1=as.data.frame(t(df))
df1$sorted_array1=order(df1[,2])
df1$sorted_array2=order(df1[,3])
df1$sorted_array3=order(df1[,4])
df1$average=colMeans(df1[1,4:6],na.rm=TRUE)
df=read.csv("/Users/muhtasim/Desktop/Stat565_HW2/data_normal.csv",header = TRUE)
#r1=order(df[1,])
#r2=sort(df[2,])
#r3=sort(df[3,])
#library(dplyr)
#df1=rbind(r1,r2,r3)
df1=as.data.frame(t(df))
df1$sorted_array1=order(df1[,2])
df1$sorted_array2=order(df1[,3])
df1$sorted_array3=order(df1[,4])
df1$average=colMeans(df1[1,4:6],na.rm=TRUE)
df=read.csv("/Users/muhtasim/Desktop/Stat565_HW2/data_normal.csv",header = TRUE)
#r1=order(df[1,])
#r2=sort(df[2,])
#r3=sort(df[3,])
#library(dplyr)
#df1=rbind(r1,r2,r3)
df1=as.data.frame(t(df))
df1$sorted_array1=order(df1[,2])
df1$sorted_array2=order(df1[,3])
df1$sorted_array3=order(df1[,4])
#df1$average=colMeans(df1[1,4:6],na.rm=TRUE)
df=read.csv("/Users/muhtasim/Desktop/Stat565_HW2/data_normal.csv",header = FALSE)
df=read.csv("/Users/muhtasim/Desktop/Stat565_HW2/data_normal.csv",header = FALSE)
#r1=order(df[1,])
#r2=sort(df[2,])
#r3=sort(df[3,])
#library(dplyr)
#df1=rbind(r1,r2,r3)
df1=as.data.frame(t(df))
df1$sorted_array1=order(df1[,2])
df1$sorted_array2=order(df1[,3])
df1$sorted_array3=order(df1[,4])
#df1$average=colMeans(df1[1,4:6],na.rm=TRUE)
df=read.csv("/Users/muhtasim/Desktop/Stat565_HW2/data_normal.csv",header = FALSE)
#r1=order(df[1,])
#r2=sort(df[2,])
#r3=sort(df[3,])
#library(dplyr)
#df1=rbind(r1,r2,r3)
df1=as.data.frame(t(df))
df1$sorted_array1=sort(df1[,2])
df1$sorted_array2=sort(df1[,3])
df1$sorted_array3=sort(df1[,4])
#df1$average=colMeans(df1[1,4:6],na.rm=TRUE)
df=read.csv("/Users/muhtasim/Desktop/Stat565_HW2/data_normal.csv",header = FALSE)
#r1=order(df[1,])
#r2=sort(df[2,])
#r3=sort(df[3,])
#library(dplyr)
#df1=rbind(r1,r2,r3)
df1=as.data.frame(t(df))
df1$sorted_array1=sort(df1[2:7,2])
df1$sorted_array2=sort(df1[2:7,3])
df1$sorted_array3=sort(df1[2:7,4])
#df1$average=colMeans(df1[1,4:6],na.rm=TRUE)
df=read.csv("/Users/muhtasim/Desktop/Stat565_HW2/data_normal.csv",header = TRUE)
#r1=order(df[1,])
#r2=sort(df[2,])
#r3=sort(df[3,])
#library(dplyr)
#df1=rbind(r1,r2,r3)
df1=as.data.frame(t(df))
df1$sorted_array1=sort(df1[2:7,2])
df1$sorted_array2=sort(df1[2:7,3])
df1$sorted_array3=sort(df1[2:7,4])
#df1$average=colMeans(df1[1,4:6],na.rm=TRUE)
df=read.csv("/Users/muhtasim/Desktop/Stat565_HW2/data_normal.csv",row.names = "Array1","Array2","Array3")
df=read.csv("/Users/muhtasim/Desktop/Stat565_HW2/data_normal.csv",row.names = "Array1,Array2,Array3")
df=read.csv("/Users/muhtasim/Desktop/Stat565_HW2/data_normal.csv",)
r1=order(df[1,])
r2=sort(df[2,])
r3=sort(df[3,])
library(dplyr)
df1=rbind(r1,r2,r3)
#df1=as.data.frame(t(df))
#df1$sorted_array1=sort(df1[2:7,2])
#df1$sorted_array2=sort(df1[2:7,3])
#df1$sorted_array3=sort(df1[2:7,4])
#df1$average=colMeans(df1[1,4:6],na.rm=TRUE)
df=read.csv("/Users/muhtasim/Desktop/Stat565_HW2/data_normal.csv",)
r1=sort(df[1,])
r2=sort(df[2,])
r3=sort(df[3,])
library(dplyr)
df1=rbind(r1,r2,r3)
#df1=as.data.frame(t(df))
#df1$sorted_array1=sort(df1[2:7,2])
#df1$sorted_array2=sort(df1[2:7,3])
#df1$sorted_array3=sort(df1[2:7,4])
#df1$average=colMeans(df1[1,4:6],na.rm=TRUE)
df=read.csv("/Users/muhtasim/Desktop/Stat565_HW2/data_normal.csv",)
r1=sort(df[1,])
r2=sort(df[2,])
r3=sort(df[3,])
library(dplyr)
df1=rbind(r1,r2,r3)
#df1=as.data.frame(t(df))
#df1$sorted_array1=sort(df1[2:7,2])
#df1$sorted_array2=sort(df1[2:7,3])
#df1$sorted_array3=sort(df1[2:7,4])
#df1$average=colMeans(df1[1,4:6],na.rm=TRUE)
df=read.csv("/Users/muhtasim/Desktop/Stat565_HW2/data_normal.csv",header=FALSE)
r1=sort(df[1,])
r2=sort(df[2,])
r3=sort(df[3,])
library(dplyr)
df1=rbind(r1,r2,r3)
#df1=as.data.frame(t(df))
#df1$sorted_array1=sort(df1[2:7,2])
#df1$sorted_array2=sort(df1[2:7,3])
#df1$sorted_array3=sort(df1[2:7,4])
#df1$average=colMeans(df1[1,4:6],na.rm=TRUE)
df=read.csv("/Users/muhtasim/Desktop/Stat565_HW2/data_normal.csv",header=FALSE)
r1=sort(df[1,])
r2=sort(df[2,])
r3=sort(df[3,])
library(dplyr)
df1=rbind(r1,r2,r3)
#df1=as.data.frame(t(df))
#df1$sorted_array1=sort(df1[2:7,2])
#df1$sorted_array2=sort(df1[2:7,3])
#df1$sorted_array3=sort(df1[2:7,4])
#df1$average=colMeans(df1[1,4:6],na.rm=TRUE)
df=read.csv("/Users/muhtasim/Desktop/Stat565_HW2/data_normal.csv",header=TRUE)
df=read.csv("/Users/muhtasim/Desktop/Stat565_HW2/data_normal.csv",header=TRUE)
r1=sort(df[1,])
r2=sort(df[2,])
r3=sort(df[3,])
library(dplyr)
df1=rbind(r1,r2,r3)
#df1=as.data.frame(t(df))
#df1$sorted_array1=sort(df1[2:7,2])
#df1$sorted_array2=sort(df1[2:7,3])
#df1$sorted_array3=sort(df1[2:7,4])
#df1$average=colMeans(df1[1,4:6],na.rm=TRUE)
data=read.csv("/Users/muhtasim/Desktop/Stat565_HW2/data_normal.csv",header=TRUE)
head(data)
rownames(data) <- data[,1]
data_mat <- data.matrix(data[,-1])
head(data_mat)
data_norm <- normalize.quantiles(data_mat, copy = TRUE)
View(data_nom)
View(data_norm)
data=read.csv("/Users/muhtasim/Desktop/Stat565_HW2/data_normal.csv",header=TRUE)
View(data)
mat1=matrix(c(16,0,9,11,7,13,3,5,14,8),ncol=2)
normalize.quantiles(mat1) #function for quantile normalization
data=read.csv("loessdata2.csv",header=TRUE)
head(data)
y1=data$x2
y2=data$y2
M=y1-y2
A=(y1+y2)/2
plot(y1,y2)
plot(A,M)
lw1 <- loess(M ~ A,data=data,span=0.10)
plot(M ~ A, data=data,main="Loess Plot using Span of 0.10")
j <- order(A)
lines(A[j],lw1$fitted[j],col="red",lwd=3)
lw2 <- loess(M ~ A,data=data,span=0.30)
plot(M ~ A, data=data,main="Loess Plot using Span of 0.30")
j1 <- order(A)
lines(A[j1],lw2$fitted[j1],col="green",lwd=3)
lw3 <- loess(M ~ A,data=data,span=0.50)
plot(M ~ A, data=data, main="Loess Plot using Span of 0.50")
j2 <- order(A)
lines(A[j2],lw3$fitted[j2],col="blue",lwd=3)
lw4 <- loess(M ~ A,data=data,span=0.70)
plot(M ~ A, data=data, main="Loess Plot using Span of 0.70")
j3 <- order(A)
lines(A[j3],lw4$fitted[j3],col="yellow",lwd=3)
lw5 <- loess(M ~ A,data=data,span=0.90)
plot(M ~ A, data=data,main="Loess Plot using Span of 0.90")
j4 <- order(A)
lines(A[j4],lw5$fitted[j4],col="brown",lwd=3)
#plotting all the lines together
# plot(M ~ A, data=data)
# lines(A[j],lw1$fitted[j],col="red",lwd=3)
# lines(A[j1],lw2$fitted[j1],col="green",lwd=3)
# lines(A[j2],lw3$fitted[j2],col="blue",lwd=3)
# lines(A[j3],lw4$fitted[j3],col="yellow",lwd=3)
# lines(A[j4],lw5$fitted[j4],col="brown",lwd=3)
array1 = c(5.390,	12.074,		3.247,		4.274,		11.24,	14.861)
array2 = c(5.813,	 8.777,		2.914,		2.736,		6.398,	23.020)
array3 = c(7.522,	 7.719,		1.783,		10.59,		4.439,	21.972)
array1_s = sort(array1)
array2_s = sort(array2)
array3_s = sort(array3)
matrix = rbind(c(5.390,	12.074,		3.247,		4.274,		11.24,	14.861),
c(5.813,	 8.777,		2.914,		2.736,		6.398,	23.020),
c(7.522,	 7.719,		1.783,		10.59,		4.439,	21.972))
matrix_s = rbind(array1_s, array2_s, array3_s)
c_means = colMeans(matrix_s)
for(i in 0:length(array1_s)+1){
matrix[matrix == array1_s[i]] = c_means[i]
matrix[matrix == array2_s[i]] = c_means[i]
matrix[matrix == array3_s[i]] = c_means[i]
}
matrix
library(affyPLM)
library(preprocessCore)
a.data=ReadAffy()
library(affyPLM)
library(preprocessCore)
a.data=ReadAffy()
library(affyPLM)
library(preprocessCore)
a.data=ReadAffy()
boxplot(a.data)
hist(a.data,col=0:6,main="Histogram of probe intensities")
MAplot(a.data)
par(mfrow=c(2,3))
MAplot(a.data)
eset.mas5=mas5(a.data)
boxplot(eset.mas5)
hist(eset.mas5,col=0:6,main="Histogram of probe intensities")
MAplot(eset.mas5)
par(mfrow=c(2,3))
MAplot(eset.mas5)
eset.rma=rma(a.data)
boxplot(eset.rma)
hist(eset.rma,col=0:6,main="Histogram of probe intensities")
par(mfrow=c(2,3))
MAplot(eset.rma)
df = read.csv("hw1.csv")
IM<-ifelse(df$MM1>df$PM1,df$PM1/(2^tuk_avg),df$MM1)
df = read.csv("/Users/muhtasim/Desktop/HW1/hw1.csv")
y= log2(df$PM1) - log2(df$MM1)
md<-median(y)
z<-abs(y-md)
mz<-median(z)
u<-(y-md)/(5*mz+.0001)
w<-ifelse(abs(u)<=1,(1-u^2)^2,0)
table.data=cbind(y,md,z,mz,u,w)
tuk_avg=sum(y*w)/sum(w)
tuk_avg
IM<-ifelse(df$MM1>df$PM1,df$PM1/(2^tuk_avg),df$MM1)
i1<-IM
ys<-log2(df$PM1-i1)
ms<-median(ys)
zs<-abs(ys-ms)
ss<-median(zs)
us<-(ys-ms)/(5*ss+.0001)
ws<-ifelse(abs(us)<=1,(1-us^2)^2,0)
tbs<-sum(ws*ys)/sum(ws)
sgnl<-2^tbs
sgnl
lw5 <- loess(M ~ A,data=data,span=0.90)
data=read.csv("loessdata2.csv",header=TRUE)
#head(data)
y1=data$x2
y2=data$y2
M=y1-y2
A=(y1+y2)/2
plot(y1,y2)
plot(A,M)
j <- order(A)
lw1 <- loess(M ~ A,data=data,span=0.10)
lw2 <- loess(M ~ A,data=data,span=0.30)
lw3 <- loess(M ~ A,data=data,span=0.50)
lw4 <- loess(M ~ A,data=data,span=0.70)
lw5 <- loess(M ~ A,data=data,span=0.90)
#plotting all the lines together
plot(M ~ A, data=data)
lines(A[j],lw1$fitted[j],col="red",lwd=3)
lines(A[j],lw2$fitted[j1],col="green",lwd=3)
lines(A[j],lw3$fitted[j2],col="blue",lwd=3)
lines(A[j],lw4$fitted[j3],col="yellow",lwd=3)
lines(A[j],lw5$fitted[j4],col="brown",lwd=3)
data=read.csv("loessdata2.csv",header=TRUE)
#head(data)
y1=data$x2
y2=data$y2
M=y1-y2
A=(y1+y2)/2
plot(y1,y2)
plot(A,M)
j <- order(A)
lw1 <- loess(M ~ A,data=data,span=0.10)
lw2 <- loess(M ~ A,data=data,span=0.30)
lw3 <- loess(M ~ A,data=data,span=0.50)
lw4 <- loess(M ~ A,data=data,span=0.70)
lw5 <- loess(M ~ A,data=data,span=0.90)
#plotting all the lines together
plot(M ~ A, data=data)
lines(A[j],lw1$fitted[j],col="red",lwd=3)
lines(A[j],lw2$fitted[j1],col="green",lwd=3)
lines(A[j],lw3$fitted[j2],col="blue",lwd=3)
lines(A[j],lw4$fitted[j3],col="yellow",lwd=3)
lines(A[j],lw5$fitted[j4],col="brown",lwd=3)
data=read.csv("loessdata2.csv",header=TRUE)
#head(data)
y1=data$x2
y2=data$y2
M=y1-y2
A=(y1+y2)/2
plot(y1,y2)
plot(A,M)
j <- order(A)
lw1 <- loess(M ~ A,data=data,span=0.10)
lw2 <- loess(M ~ A,data=data,span=0.30)
lw3 <- loess(M ~ A,data=data,span=0.50)
lw4 <- loess(M ~ A,data=data,span=0.70)
lw5 <- loess(M ~ A,data=data,span=0.90)
#plotting all the lines together
plot(M ~ A, data=data)
lines(A[j],lw1$fitted[j],col="red",lwd=3)
lines(A[j],lw2$fitted[j1],col="green",lwd=3)
lines(A[j],lw3$fitted[j2],col="blue",lwd=3)
lines(A[j],lw4$fitted[j3],col="yellow",lwd=3)
lines(A[j],lw5$fitted[j4],col="brown",lwd=3)
data=read.csv("loessdata2.csv",header=TRUE)
#head(data)
y1=data$x2
y2=data$y2
M=y1-y2
A=(y1+y2)/2
plot(y1,y2)
plot(A,M)
j <- order(A)
lw1 <- loess(M ~ A,data=data,span=0.10)
lw2 <- loess(M ~ A,data=data,span=0.30)
lw3 <- loess(M ~ A,data=data,span=0.50)
lw4 <- loess(M ~ A,data=data,span=0.70)
lw5 <- loess(M ~ A,data=data,span=0.90)
#plotting all the lines together
plot(M ~ A, data=data)
lines(A[j],lw1$fitted[j],col="red",lwd=3)
lines(A[j],lw2$fitted[j],col="green",lwd=3)
lines(A[j],lw3$fitted[j],col="blue",lwd=3)
lines(A[j],lw4$fitted[j],col="yellow",lwd=3)
lines(A[j],lw5$fitted[j],col="brown",lwd=3)
data=read.csv("loessdata2.csv",header=TRUE)
#head(data)
y1=data$x2
y2=data$y2
M=y1-y2
A=(y1+y2)/2
plot(y1,y2)
plot(A,M)
j <- order(A)
lw1 <- loess(M ~ A,data=data,span=0.10)
lw2 <- loess(M ~ A,data=data,span=0.30)
lw3 <- loess(M ~ A,data=data,span=0.50)
lw4 <- loess(M ~ A,data=data,span=0.70)
lw5 <- loess(M ~ A,data=data,span=0.90)
#plotting all the lines together
plot(M ~ A, data=data)
lines(A[j],lw1$fitted[j],col="red",lwd=3)
lines(A[j],lw2$fitted[j],col="green",lwd=3)
lines(A[j],lw3$fitted[j],col="blue",lwd=3)
lines(A[j],lw4$fitted[j],col="yellow",lwd=3)
lines(A[j],lw5$fitted[j],col="brown",lwd=3)
data=read.csv("loessdata2.csv",header=TRUE)
#head(data)
y1=data$x2
y2=data$y2
M=y1-y2
A=(y1+y2)/2
plot(y1,y2)
plot(A,M)
j <- order(A)
lw1 <- loess(M ~ A,data=data,span=0.10)
lw2 <- loess(M ~ A,data=data,span=0.30)
lw3 <- loess(M ~ A,data=data,span=0.50)
lw4 <- loess(M ~ A,data=data,span=0.70)
lw5 <- loess(M ~ A,data=data,span=0.90)
#plotting all the lines together
plot(M ~ A, data=data)
lines(A[j],lw1$fitted[j],col="red",lwd=3)
lines(A[j],lw2$fitted[j],col="green",lwd=3)
lines(A[j],lw3$fitted[j],col="blue",lwd=3)
lines(A[j],lw4$fitted[j],col="yellow",lwd=3)
lines(A[j],lw5$fitted[j],col="brown",lwd=3)
eset.mas5=mas5(a.data)
boxplot(eset.mas5)
eset.mas5=mas5(a.data)
boxplot(eset.mas5)
array1 = c(5.390,	12.074,		3.247,		4.274,		11.24,	14.861)
array2 = c(5.813,	 8.777,		2.914,		2.736,		6.398,	23.020)
array3 = c(7.522,	 7.719,		1.783,		10.59,		4.439,	21.972)
array1_s = sort(array1)
array2_s = sort(array2)
array3_s = sort(array3)
matrix = rbind(c(5.390,	12.074,		3.247,		4.274,		11.24,	14.861),
c(5.813,	 8.777,		2.914,		2.736,		6.398,	23.020),
c(7.522,	 7.719,		1.783,		10.59,		4.439,	21.972))
matrix_s = rbind(array1_s, array2_s, array3_s)
c_means = colMeans(matrix_s)
for(i in 0:length(array1_s)+1){
matrix[matrix == array1_s[i]] = c_means[i]
matrix[matrix == array2_s[i]] = c_means[i]
matrix[matrix == array3_s[i]] = c_means[i]
}
matrix
## Question 2
#Consider the following are data from 3 arrays 6 spots each.  Give the quantile-normalized array values.
array1 = c(5.390,	12.074,		3.247,		4.274,		11.24,	14.861)
array2 = c(5.813,	 8.777,		2.914,		2.736,		6.398,	23.020)
array3 = c(7.522,	 7.719,		1.783,		10.59,		4.439,	21.972)
array1_s = sort(array1)
array2_s = sort(array2)
array3_s = sort(array3)
matrix = rbind(c(5.390,	12.074,		3.247,		4.274,		11.24,	14.861),
c(5.813,	 8.777,		2.914,		2.736,		6.398,	23.020),
c(7.522,	 7.719,		1.783,		10.59,		4.439,	21.972))
matrix_s = rbind(array1_s, array2_s, array3_s)
c_means = colMeans(matrix_s)
for(i in 0:length(array1_s)+1){
matrix[matrix == array1_s[i]] = c_means[i]
matrix[matrix == array2_s[i]] = c_means[i]
matrix[matrix == array3_s[i]] = c_means[i]
}
matrix
matrix
matrix
matrix
matrix
## Question 2
#Consider the following are data from 3 arrays 6 spots each.  Give the quantile-normalized array values.
array1 = c(5.390,	12.074,		3.247,		4.274,		11.24,	14.861)
array2 = c(5.813,	 8.777,		2.914,		2.736,		6.398,	23.020)
array3 = c(7.522,	 7.719,		1.783,		10.59,		4.439,	21.972)
array1_s = sort(array1)
array2_s = sort(array2)
array3_s = sort(array3)
matrix = rbind(c(5.390,	12.074,		3.247,		4.274,		11.24,	14.861),
c(5.813,	 8.777,		2.914,		2.736,		6.398,	23.020),
c(7.522,	 7.719,		1.783,		10.59,		4.439,	21.972))
matrix
length(array1_s)
for(i in 0:length(array1_s)){
matrix[matrix == array1_s[i]] = c_means[i]
matrix[matrix == array2_s[i]] = c_means[i]
matrix[matrix == array3_s[i]] = c_means[i]
}
matrix
matrix
## Question 2
#Consider the following are data from 3 arrays 6 spots each.  Give the quantile-normalized array values.
array1 = c(5.390,	12.074,		3.247,		4.274,		11.24,	14.861)
array2 = c(5.813,	 8.777,		2.914,		2.736,		6.398,	23.020)
array3 = c(7.522,	 7.719,		1.783,		10.59,		4.439,	21.972)
array1_s = sort(array1)
array2_s = sort(array2)
array3_s = sort(array3)
matrix = rbind(c(5.390,	12.074,		3.247,		4.274,		11.24,	14.861),
c(5.813,	 8.777,		2.914,		2.736,		6.398,	23.020),
c(7.522,	 7.719,		1.783,		10.59,		4.439,	21.972))
matrix_s = rbind(array1_s, array2_s, array3_s)
c_means = colMeans(matrix_s)
for(i in 0:length(array1_s)){
matrix[matrix == array1_s[i]] = c_means[i]
matrix[matrix == array2_s[i]] = c_means[i]
matrix[matrix == array3_s[i]] = c_means[i]
}
matrix
matrix
## Question 2
#Consider the following are data from 3 arrays 6 spots each.  Give the quantile-normalized array values.
array1 = c(5.390,	12.074,		3.247,		4.274,		11.24,	14.861)
array2 = c(5.813,	 8.777,		2.914,		2.736,		6.398,	23.020)
array3 = c(7.522,	 7.719,		1.783,		10.59,		4.439,	21.972)
array1_s = sort(array1)
array2_s = sort(array2)
array3_s = sort(array3)
matrix = rbind(c(5.390,	12.074,		3.247,		4.274,		11.24,	14.861),
c(5.813,	 8.777,		2.914,		2.736,		6.398,	23.020),
c(7.522,	 7.719,		1.783,		10.59,		4.439,	21.972))
matrix_s = rbind(array1_s, array2_s, array3_s)
c_means = colMeans(matrix_s)
for(i in 1:length(array1_s)){
matrix[matrix == array1_s[i]] = c_means[i]
matrix[matrix == array2_s[i]] = c_means[i]
matrix[matrix == array3_s[i]] = c_means[i]
}
matrix
c-means
c_means
